<!doctype html>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta charset='utf-8'>
<link rel='stylesheet' href='/css/main.css'>
<title>競技プログラミング</title>
<h1>競技プログラミング</h1>
<a href='/'>[Top]</a>
<hr>
<h3>Table of Contents</h3>
<div id='toc'></div>
<div id='content'>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>競プロのお供．</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_c">C++</h2>
<div class="sectionbody">
<div class="paragraph"><p>断りがない限りC++14を想定しています．</p></div>
<div class="paragraph"><p><a href="https://cpprefjp.github.io/">cpprefjp</a></p></div>
<div class="sect2">
<h3 id="_言語機能">言語機能</h3>
<div class="sect3">
<h4 id="_range_based_for_statement">range-based for statement</h4>
<div class="paragraph"><p><a href="https://cpprefjp.github.io/lang/cpp11/range_based_for.html">range based for</a></p></div>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">// 非破壊，eを変更可</span>
<span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">auto</span> e <span style="color:#000000">:</span> es<span style="color:#000000">){</span>
    <span style="color:#000000">...</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 破壊，eを変更可</span>
<span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">auto</span> <span style="color:#000000">&amp;</span>e <span style="color:#000000">:</span> es<span style="color:#000000">){</span>
    <span style="color:#000000">...</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 非破壊，eを変更不可</span>
<span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#0057ae">const</span> <span style="color:#000000; font-weight:bold">auto</span> <span style="color:#000000">&amp;</span>e <span style="color:#000000">:</span> es<span style="color:#000000">){</span>
    <span style="color:#000000">...</span>
<span style="color:#000000">}</span></code></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="_リファレンス">リファレンス</h3>
<div class="sect3">
<h4 id="_algorithm">algorithm</h4>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#008200">#include &lt;algorithm&gt;</span>

<span style="color:#838183; font-style:italic">// 要素の最大値を指す最初のイテレータを取得</span>
cout <span style="color:#000000">&lt;&lt; *</span><span style="color:#010181">max_element</span><span style="color:#000000">(</span>v<span style="color:#000000">.</span><span style="color:#010181">begin</span><span style="color:#000000">(),</span> v<span style="color:#000000">.</span><span style="color:#010181">end</span><span style="color:#000000">()) &lt;&lt;</span> endl<span style="color:#000000">;</span></code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_map">map</h4>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#008200">#include &lt;map&gt;</span>

<span style="color:#838183; font-style:italic">// 検索</span>
<span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>mmap<span style="color:#000000">.</span><span style="color:#010181">find</span><span style="color:#000000">(</span>key<span style="color:#000000">) !=</span> mmap<span style="color:#000000">.</span><span style="color:#010181">end</span><span style="color:#000000">()){</span>
    <span style="color:#000000">...</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// range based loop</span>
<span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">auto</span> kv <span style="color:#000000">:</span> mmap<span style="color:#000000">){</span>
    <span style="color:#000000; font-weight:bold">auto</span> key    <span style="color:#000000">=</span> kv<span style="color:#000000">.</span>fist<span style="color:#000000">;</span>
    <span style="color:#000000; font-weight:bold">auto</span> value  <span style="color:#000000">=</span> kv<span style="color:#000000">.</span>second<span style="color:#000000">;</span>
    <span style="color:#000000">...</span>
<span style="color:#000000">}</span></code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_queue">queue</h4>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#008200">#include &lt;queue&gt;</span>

<span style="color:#838183; font-style:italic">// queue</span>
q<span style="color:#000000">.</span><span style="color:#010181">push</span><span style="color:#000000">(</span>v<span style="color:#000000">);</span>
<span style="color:#000000; font-weight:bold">auto</span> v <span style="color:#000000">=</span> q<span style="color:#000000">.</span><span style="color:#010181">front</span><span style="color:#000000">();</span>
q<span style="color:#000000">.</span><span style="color:#010181">pop</span><span style="color:#000000">();</span>

<span style="color:#838183; font-style:italic">// priority queue</span>
pq<span style="color:#000000">.</span><span style="color:#010181">push</span><span style="color:#000000">(</span>v<span style="color:#000000">);</span>
<span style="color:#000000; font-weight:bold">auto</span> v <span style="color:#000000">=</span> pq<span style="color:#000000">.</span><span style="color:#010181">top</span><span style="color:#000000">();</span>
pq<span style="color:#000000">.</span><span style="color:#010181">pop</span><span style="color:#000000">();</span>

<span style="color:#838183; font-style:italic">// priority queue は標準で降順なので，ダイクストラで使うときは次のようにする</span>
priority_queue<span style="color:#000000">&lt;</span>T<span style="color:#000000">,</span> vector<span style="color:#000000">&lt;</span>T<span style="color:#000000">&gt;,</span> greater<span style="color:#000000">&lt;</span>T<span style="color:#000000">&gt;&gt;</span> pq<span style="color:#000000">;</span></code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_stack">stack</h4>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#008200">#include &lt;stack&gt;</span>

s<span style="color:#000000">.</span><span style="color:#010181">push</span><span style="color:#000000">(</span>v<span style="color:#000000">);</span>
<span style="color:#000000; font-weight:bold">auto</span> v <span style="color:#000000">=</span> s<span style="color:#000000">.</span><span style="color:#010181">top</span><span style="color:#000000">();</span>
s<span style="color:#000000">.</span><span style="color:#010181">pop</span><span style="color:#000000">();</span></code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_string">string</h4>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#008200">#include &lt;string&gt;</span>

<span style="color:#838183; font-style:italic">// 行読み込み</span>
<span style="color:#010181">getline</span><span style="color:#000000">(</span>cin<span style="color:#000000">,</span> str<span style="color:#000000">);</span>

<span style="color:#838183; font-style:italic">// 文字を結合するときは+=かpush_back等を使う</span>
str <span style="color:#000000">+=</span> <span style="color:#bf0303">'c'</span><span style="color:#000000">;</span>

<span style="color:#838183; font-style:italic">// range based for ももちろん可</span>
<span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">auto</span> c <span style="color:#000000">:</span> str<span style="color:#000000">){</span>
    cout <span style="color:#000000">&lt;&lt;</span> c <span style="color:#000000">&lt;&lt;</span> endl<span style="color:#000000">;</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 文字列部分比較</span>
<span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>str<span style="color:#000000">.</span><span style="color:#010181">compare</span><span style="color:#000000">(</span>offset<span style="color:#000000">,</span> <span style="color:#b07e00">4</span><span style="color:#000000">,</span> <span style="color:#bf0303">&quot;hoge&quot;</span><span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span><span style="color:#000000">){</span>
    <span style="color:#000000">...</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 文字列反転</span>
<span style="color:#838183; font-style:italic">// algorithm の reverse を用いる</span>
<span style="color:#010181">reverse</span><span style="color:#000000">(</span>str<span style="color:#000000">.</span><span style="color:#010181">begin</span><span style="color:#000000">(),</span> str<span style="color:#000000">.</span><span style="color:#010181">end</span><span style="color:#000000">());</span></code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_utility">utility</h4>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#008200">#include &lt;utility&gt;</span>

<span style="color:#838183; font-style:italic">// swap</span>
<span style="color:#010181">swap</span><span style="color:#000000">(</span>v<span style="color:#000000">[</span><span style="color:#b07e00">4</span><span style="color:#000000">],</span> v<span style="color:#000000">[</span><span style="color:#b07e00">5</span><span style="color:#000000">]);</span></code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_vector">vector</h4>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#008200">#include &lt;vector&gt;</span>

<span style="color:#838183; font-style:italic">// 100個の0で初期化</span>
vector<span style="color:#000000">&lt;</span><span style="color:#0057ae">int</span><span style="color:#000000">&gt;</span> <span style="color:#010181">vec</span><span style="color:#000000">(</span><span style="color:#b07e00">100</span><span style="color:#000000">,</span> <span style="color:#b07e00">0</span><span style="color:#000000">);</span></code></pre>
</div></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_知識">知識</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_グラフ">グラフ</h3>
<div class="ulist"><ul>
<li>
<p>
任意のトーナメントグラフにはハミルトンパスが存在する(AOJ2386 Sightseeing Tour)
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="_定義">定義</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
単純グラフ
</dt>
<dd>
<p>
多重辺，ループのないグラフ
</p>
</dd>
<dt class="hdlist1">
2部グラフ
</dt>
<dd>
<p>
頂点集合を2つの部分集合に分割して，各集合内の頂点同士の間には辺が無いようなグラフ
</p>
</dd>
<dt class="hdlist1">
完全グラフ
</dt>
<dd>
<p>
任意の2頂点間に枝があるグラフ
</p>
</dd>
<dt class="hdlist1">
DAG (Directed Acyclic Graph)
</dt>
<dd>
<p>
閉路のない有向グラフ
</p>
<div class="ulist"><ul>
<li>
<p>
全ての辺が左から右に向くように，各頂点を一直線上に並べることができる．これをトポロジカル順序という．
</p>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
トーナメントグラフ
</dt>
<dd>
<p>
任意の2頂点が1つの有向辺で結ばれているグラフ
</p>
</dd>
<dt class="hdlist1">
ハミルトン(閉)路
</dt>
<dd>
<p>
全頂点を一度だけ通る(閉)路
</p>
</dd>
<dt class="hdlist1">
オイラー(閉)路
</dt>
<dd>
<p>
全辺を一度だけ通る(閉)路
</p>
</dd>
<dt class="hdlist1">
ハミルトングラフ
</dt>
<dd>
<p>
ハミルトン閉路を含むグラフ
</p>
</dd>
<dt class="hdlist1">
準ハミルトングラフ
</dt>
<dd>
<p>
ハミルトン閉路は含まないが，ハミルトン路は含むグラフ
</p>
</dd>
<dt class="hdlist1">
オイラーグラフ
</dt>
<dd>
<p>
オイラー閉路を含むグラフ
</p>
</dd>
<dt class="hdlist1">
準オイラーグラフ
</dt>
<dd>
<p>
オイラー閉路は含まないが，オイラー路は含むグラフ
</p>
</dd>
<dt class="hdlist1">
(強)連結
</dt>
<dd>
<p>
無(有)向グラフにおいて，任意の2頂点間に路が存在すること
</p>
</dd>
<dt class="hdlist1">
(強)連結成分
</dt>
<dd>
<p>
(強)連結な頂点集合に分解した際の各集合
</p>
</dd>
</dl></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ライブラリ">ライブラリ</h2>
<div class="sectionbody">
<div class="paragraph"><p><a href="https://raw.githubusercontent.com/monman53/online_judge/master/lib/header.h">&#8594;header</a></p></div>
<div class="paragraph"><p><a href="https://raw.githubusercontent.com/monman53/online_judge/master/lib/geometry.h">&#8594;geometry</a>
<a href="https://raw.githubusercontent.com/monman53/online_judge/master/lib/datastructure.h">&#8594;datastructure</a>
<a href="https://raw.githubusercontent.com/monman53/online_judge/master/lib/number.h">&#8594;number</a></p></div>
<div class="sect2">
<h3 id="_header">header</h3>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">// header {{{</span>
<span style="color:#008200">#include &lt;iostream&gt;</span>
<span style="color:#008200">#include &lt;algorithm&gt;</span>
<span style="color:#008200">#include &lt;vector&gt;</span>
<span style="color:#008200">#include &lt;complex&gt;</span>
<span style="color:#008200">#include &lt;utility&gt;</span>
<span style="color:#008200">#include &lt;string&gt;</span>
<span style="color:#008200">#include &lt;sstream&gt;</span>
<span style="color:#008200">#include &lt;queue&gt;</span>
<span style="color:#008200">#include &lt;map&gt;</span>
<span style="color:#008200">#include &lt;list&gt;</span>
<span style="color:#008200">#include &lt;stack&gt;</span>
<span style="color:#008200">#include &lt;tuple&gt;</span>
<span style="color:#008200">#include &lt;cstdio&gt;</span>
<span style="color:#008200">#include &lt;cmath&gt;</span>
<span style="color:#000000; font-weight:bold">using namespace</span> std<span style="color:#000000">;</span>

<span style="color:#008200">#define ALPHABET    26</span>
<span style="color:#008200">#define EPS         (1e-10)</span>
<span style="color:#008200">#define EQ(a, b)    (abs((a)-(b)) &lt; EPS)</span>

<span style="color:#000000; font-weight:bold">typedef</span> <span style="color:#0057ae">long long</span> ll<span style="color:#000000">;</span>
<span style="color:#000000; font-weight:bold">typedef</span> <span style="color:#0057ae">unsigned long long</span> ull<span style="color:#000000">;</span>
<span style="color:#838183; font-style:italic">// }}}</span></code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_数">数</h3>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">// number {{{</span>
<span style="color:#008200">#define SIZE      100005</span>
<span style="color:#008200">#define MOD 1000000007LL</span>

ll <span style="color:#010181">pow</span><span style="color:#000000">(</span>ll a<span style="color:#000000">,</span> ll b<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>b <span style="color:#000000">==</span> <span style="color:#b07e00">0</span><span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">return</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
    ll aa <span style="color:#000000">=</span> <span style="color:#010181">pow</span><span style="color:#000000">(</span>a<span style="color:#000000">,</span> b<span style="color:#000000">/</span><span style="color:#b07e00">2</span><span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> aa<span style="color:#000000">*</span>aa<span style="color:#000000">%</span>MOD<span style="color:#000000">*(</span>b<span style="color:#000000">%</span><span style="color:#b07e00">2</span> <span style="color:#000000">==</span> <span style="color:#b07e00">1</span> ? a <span style="color:#000000">:</span> <span style="color:#b07e00">1</span><span style="color:#000000">)%</span>MOD<span style="color:#000000">;</span>
<span style="color:#000000">}</span>

ll fact<span style="color:#000000">[</span>SIZE<span style="color:#000000">] = {</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">1</span><span style="color:#000000">};</span>
ll finv<span style="color:#000000">[</span>SIZE<span style="color:#000000">] = {</span><span style="color:#b07e00">1</span><span style="color:#000000">,</span> <span style="color:#b07e00">1</span><span style="color:#000000">};</span>

<span style="color:#0057ae">void</span> <span style="color:#010181">fact_init</span><span style="color:#000000">() {</span>
    <span style="color:#838183; font-style:italic">// fact</span>
    <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span>ll i<span style="color:#000000">=</span><span style="color:#b07e00">2</span><span style="color:#000000">;</span>i<span style="color:#000000">&lt;</span>SIZE<span style="color:#000000">;</span>i<span style="color:#000000">++){</span>
        fact<span style="color:#000000">[</span>i<span style="color:#000000">] =</span> fact<span style="color:#000000">[</span>i<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">]*</span>i<span style="color:#000000">%</span>MOD<span style="color:#000000">;</span>
    <span style="color:#000000">}</span>

    <span style="color:#838183; font-style:italic">// finv</span>
    finv<span style="color:#000000">[</span>SIZE<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> <span style="color:#010181">pow</span><span style="color:#000000">(</span>fact<span style="color:#000000">[</span>SIZE<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">],</span> MOD<span style="color:#000000">-</span><span style="color:#b07e00">2</span><span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span>ll i<span style="color:#000000">=</span>SIZE<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">;</span>i<span style="color:#000000">&gt;=</span><span style="color:#b07e00">3</span><span style="color:#000000">;</span>i<span style="color:#000000">--){</span>
        finv<span style="color:#000000">[</span>i<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">] =</span> finv<span style="color:#000000">[</span>i<span style="color:#000000">]*</span>i<span style="color:#000000">%</span>MOD<span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
<span style="color:#000000">}</span>

ll <span style="color:#010181">comb</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> n<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> r<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>r <span style="color:#000000">&gt;</span> n<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">return</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    <span style="color:#000000; font-weight:bold">return</span> fact<span style="color:#000000">[</span>n<span style="color:#000000">]*(</span>finv<span style="color:#000000">[</span>r<span style="color:#000000">]*</span>finv<span style="color:#000000">[</span>n<span style="color:#000000">-</span>r<span style="color:#000000">]%</span>MOD<span style="color:#000000">)%</span>MOD<span style="color:#000000">;</span>
<span style="color:#000000">}</span>

ll <span style="color:#010181">gcd</span><span style="color:#000000">(</span>ll x<span style="color:#000000">,</span> ll y<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">return</span> y ? <span style="color:#010181">gcd</span><span style="color:#000000">(</span>y<span style="color:#000000">,</span> x<span style="color:#000000">%</span>y<span style="color:#000000">) :</span> x<span style="color:#000000">;</span>
<span style="color:#000000">}</span>
<span style="color:#000000">}}}</span></code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_データ構造">データ構造</h3>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">// data structure {{{</span>

<span style="color:#838183; font-style:italic">// Union-Find</span>
<span style="color:#838183; font-style:italic">// verified AOJ DSL_1_A</span>
<span style="color:#0057ae">struct</span> UF <span style="color:#000000">{</span>
    vector<span style="color:#000000">&lt;</span><span style="color:#0057ae">int</span><span style="color:#000000">&gt;</span> p<span style="color:#000000">;</span>  <span style="color:#838183; font-style:italic">// parent</span>
    vector<span style="color:#000000">&lt;</span><span style="color:#0057ae">int</span><span style="color:#000000">&gt;</span> r<span style="color:#000000">;</span>  <span style="color:#838183; font-style:italic">// rank</span>

    <span style="color:#010181">UF</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> n<span style="color:#000000">) {</span>
        p<span style="color:#000000">.</span><span style="color:#010181">resize</span><span style="color:#000000">(</span>n<span style="color:#000000">);</span>
        r<span style="color:#000000">.</span><span style="color:#010181">resize</span><span style="color:#000000">(</span>n<span style="color:#000000">);</span>
        <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> i<span style="color:#000000">=</span><span style="color:#b07e00">0</span><span style="color:#000000">;</span>i<span style="color:#000000">&lt;</span>n<span style="color:#000000">;</span>i<span style="color:#000000">++){</span>
            p<span style="color:#000000">[</span>i<span style="color:#000000">] =</span> i<span style="color:#000000">;</span>
            r<span style="color:#000000">[</span>i<span style="color:#000000">] =</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>
        <span style="color:#000000">}</span>
    <span style="color:#000000">}</span>

    <span style="color:#0057ae">int</span> <span style="color:#010181">find</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> x<span style="color:#000000">) {</span>
        <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>x <span style="color:#000000">==</span> p<span style="color:#000000">[</span>x<span style="color:#000000">]){</span>
            <span style="color:#000000; font-weight:bold">return</span> x<span style="color:#000000">;</span>
        <span style="color:#000000">}</span><span style="color:#000000; font-weight:bold">else</span><span style="color:#000000">{</span>
            <span style="color:#000000; font-weight:bold">return</span> p<span style="color:#000000">[</span>x<span style="color:#000000">] =</span> <span style="color:#010181">find</span><span style="color:#000000">(</span>p<span style="color:#000000">[</span>x<span style="color:#000000">]);</span>
        <span style="color:#000000">}</span>
    <span style="color:#000000">}</span>

    <span style="color:#0057ae">void</span> <span style="color:#010181">unite</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> x<span style="color:#000000">,</span> <span style="color:#0057ae">int</span> y<span style="color:#000000">) {</span>
        x <span style="color:#000000">=</span> <span style="color:#010181">find</span><span style="color:#000000">(</span>x<span style="color:#000000">);</span>
        y <span style="color:#000000">=</span> <span style="color:#010181">find</span><span style="color:#000000">(</span>y<span style="color:#000000">);</span>
        <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>x <span style="color:#000000">==</span> y<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">return</span><span style="color:#000000">;</span>
        <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>r<span style="color:#000000">[</span>x<span style="color:#000000">] &lt;</span> r<span style="color:#000000">[</span>y<span style="color:#000000">]){</span>
            p<span style="color:#000000">[</span>x<span style="color:#000000">] =</span> y<span style="color:#000000">;</span>
        <span style="color:#000000">}</span><span style="color:#000000; font-weight:bold">else</span><span style="color:#000000">{</span>
            p<span style="color:#000000">[</span>y<span style="color:#000000">] =</span> x<span style="color:#000000">;</span>
            <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>r<span style="color:#000000">[</span>x<span style="color:#000000">] ==</span> r<span style="color:#000000">[</span>y<span style="color:#000000">]){</span>
                r<span style="color:#000000">[</span>x<span style="color:#000000">]++;</span>
            <span style="color:#000000">}</span>
        <span style="color:#000000">}</span>
    <span style="color:#000000">}</span>
<span style="color:#000000">};</span>

<span style="color:#838183; font-style:italic">// 最小全域木 (Minimum spanning tree)</span>
<span style="color:#838183; font-style:italic">// ARC076D</span>
<span style="color:#0057ae">struct</span> MST <span style="color:#000000">{</span>
    <span style="color:#838183; font-style:italic">// クラスカル法</span>
    <span style="color:#0057ae">static</span> vector<span style="color:#000000">&lt;</span>E<span style="color:#000000">&gt;</span> <span style="color:#010181">solve</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> n<span style="color:#000000">,</span> vector<span style="color:#000000">&lt;</span>E<span style="color:#000000">&gt;</span> e<span style="color:#000000">) {</span>
        UF <span style="color:#010181">uf</span><span style="color:#000000">(</span>n<span style="color:#000000">);</span>
        vector<span style="color:#000000">&lt;</span>E<span style="color:#000000">&gt;</span> ret<span style="color:#000000">;</span>
        <span style="color:#010181">sort</span><span style="color:#000000">(</span>e<span style="color:#000000">.</span><span style="color:#010181">begin</span><span style="color:#000000">(),</span> e<span style="color:#000000">.</span><span style="color:#010181">end</span><span style="color:#000000">(), [](</span>E e1<span style="color:#000000">,</span> E e2<span style="color:#000000">){</span>
                <span style="color:#000000; font-weight:bold">return</span> e1<span style="color:#000000">.</span>w <span style="color:#000000">&lt;</span> e2<span style="color:#000000">.</span>w<span style="color:#000000">;</span>
                <span style="color:#000000">});</span>
        <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#000000; font-weight:bold">auto</span> ee <span style="color:#000000">:</span> e<span style="color:#000000">){</span>
            <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span>uf<span style="color:#000000">.</span><span style="color:#010181">find</span><span style="color:#000000">(</span>ee<span style="color:#000000">.</span>s<span style="color:#000000">) !=</span> uf<span style="color:#000000">.</span><span style="color:#010181">find</span><span style="color:#000000">(</span>ee<span style="color:#000000">.</span>t<span style="color:#000000">)){</span>
                uf<span style="color:#000000">.</span><span style="color:#010181">unite</span><span style="color:#000000">(</span>ee<span style="color:#000000">.</span>s<span style="color:#000000">,</span> ee<span style="color:#000000">.</span>t<span style="color:#000000">);</span>
                ret<span style="color:#000000">.</span><span style="color:#010181">push_back</span><span style="color:#000000">({</span>ee<span style="color:#000000">.</span>w<span style="color:#000000">,</span> ee<span style="color:#000000">.</span>s<span style="color:#000000">,</span> ee<span style="color:#000000">.</span>t<span style="color:#000000">});</span>
            <span style="color:#000000">}</span>
        <span style="color:#000000">}</span>
        <span style="color:#000000; font-weight:bold">return</span> ret<span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
<span style="color:#000000">};</span>
<span style="color:#838183; font-style:italic">//}}}</span></code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_平面幾何">平面幾何</h3>
<div class="listingblock">
<div class="content">
<pre><code><span style="color:#838183; font-style:italic">// 2d geometry {{{</span>

<span style="color:#000000; font-weight:bold">typedef</span> <span style="color:#0057ae">complex</span><span style="color:#000000">&lt;</span><span style="color:#0057ae">double</span><span style="color:#000000">&gt;</span> P<span style="color:#000000">;</span>
<span style="color:#000000; font-weight:bold">typedef</span> vector<span style="color:#000000">&lt;</span>P<span style="color:#000000">&gt;</span> PL<span style="color:#000000">;</span>

<span style="color:#000000; font-weight:bold">namespace</span> std <span style="color:#000000">{</span>
    <span style="color:#0057ae">bool</span>  <span style="color:#000000; font-weight:bold">operator</span> <span style="color:#000000">&lt; (</span>P a<span style="color:#000000">,</span> P b<span style="color:#000000">) {</span>
        <span style="color:#838183; font-style:italic">// return real(a) != real(b) ? real(a) &lt; real(b) : imag(a) &lt; imag(b);</span>
        <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">imag</span><span style="color:#000000">(</span>a<span style="color:#000000">) !=</span> <span style="color:#010181">imag</span><span style="color:#000000">(</span>b<span style="color:#000000">)</span> ? <span style="color:#010181">imag</span><span style="color:#000000">(</span>a<span style="color:#000000">) &lt;</span> <span style="color:#010181">imag</span><span style="color:#000000">(</span>b<span style="color:#000000">) :</span> <span style="color:#010181">real</span><span style="color:#000000">(</span>a<span style="color:#000000">) &lt;</span> <span style="color:#010181">real</span><span style="color:#000000">(</span>b<span style="color:#000000">);</span>
    <span style="color:#000000">}</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 長さ</span>
<span style="color:#838183; font-style:italic">// double length = abs(a);</span>

<span style="color:#838183; font-style:italic">// 単位ベクトル</span>
<span style="color:#838183; font-style:italic">// P n = a/abs(a);</span>

<span style="color:#838183; font-style:italic">// 法線ベクトル</span>
<span style="color:#838183; font-style:italic">// P n1 = a*P(0, 1);</span>
<span style="color:#838183; font-style:italic">// P n2 = a*P(0, -1);</span>

<span style="color:#838183; font-style:italic">// 内積</span>
<span style="color:#0057ae">double</span> <span style="color:#010181">dot</span><span style="color:#000000">(</span>P a<span style="color:#000000">,</span> P b<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">return</span> a<span style="color:#000000">.</span><span style="color:#010181">real</span><span style="color:#000000">()*</span>b<span style="color:#000000">.</span><span style="color:#010181">real</span><span style="color:#000000">() +</span> a<span style="color:#000000">.</span><span style="color:#010181">imag</span><span style="color:#000000">()*</span>b<span style="color:#000000">.</span><span style="color:#010181">imag</span><span style="color:#000000">();</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 外積</span>
<span style="color:#0057ae">double</span> <span style="color:#010181">cross</span><span style="color:#000000">(</span>P a<span style="color:#000000">,</span> P b<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">return</span> a<span style="color:#000000">.</span><span style="color:#010181">real</span><span style="color:#000000">()*</span>b<span style="color:#000000">.</span><span style="color:#010181">imag</span><span style="color:#000000">() -</span> a<span style="color:#000000">.</span><span style="color:#010181">imag</span><span style="color:#000000">()*</span>b<span style="color:#000000">.</span><span style="color:#010181">real</span><span style="color:#000000">();</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 点の直線への射影</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_1_A</span>
P <span style="color:#010181">projectionLP</span><span style="color:#000000">(</span>P a<span style="color:#000000">,</span> P b<span style="color:#000000">,</span> P p<span style="color:#000000">) {</span>
    <span style="color:#0057ae">double</span> l <span style="color:#000000">=</span> <span style="color:#010181">dot</span><span style="color:#000000">(</span>p<span style="color:#000000">-</span>a<span style="color:#000000">,</span> b<span style="color:#000000">-</span>a<span style="color:#000000">) /</span> <span style="color:#010181">norm</span><span style="color:#000000">(</span>b<span style="color:#000000">-</span>a<span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> a <span style="color:#000000">+</span> l<span style="color:#000000">*(</span>b<span style="color:#000000">-</span>a<span style="color:#000000">);</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 点の直線に対する対称点</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_1_B</span>
P <span style="color:#010181">reflectionLP</span><span style="color:#000000">(</span>P a<span style="color:#000000">,</span> P b<span style="color:#000000">,</span> P p<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#b07e00">2.0</span><span style="color:#000000">*</span><span style="color:#010181">projectionLP</span><span style="color:#000000">(</span>a<span style="color:#000000">,</span> b<span style="color:#000000">,</span> p<span style="color:#000000">) -</span> p<span style="color:#000000">;</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// verified AOJ CGL_1_C</span>
<span style="color:#0057ae">int</span> <span style="color:#010181">ccw</span><span style="color:#000000">(</span>P a<span style="color:#000000">,</span> P b<span style="color:#000000">,</span> P c<span style="color:#000000">) {</span>
    b <span style="color:#000000">=</span> b <span style="color:#000000">-</span> a<span style="color:#000000">;</span>
    c <span style="color:#000000">=</span> c <span style="color:#000000">-</span> a<span style="color:#000000">;</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">cross</span><span style="color:#000000">(</span>b<span style="color:#000000">,</span> c<span style="color:#000000">) &gt;</span> EPS<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">return</span> <span style="color:#000000">+</span><span style="color:#b07e00">1</span><span style="color:#000000">;</span> <span style="color:#838183; font-style:italic">// counter clockwise</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">cross</span><span style="color:#000000">(</span>b<span style="color:#000000">,</span> c<span style="color:#000000">) &lt;-</span>EPS<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">return</span> <span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">;</span> <span style="color:#838183; font-style:italic">// clockwise</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">dot</span><span style="color:#000000">(</span>b<span style="color:#000000">,</span> c<span style="color:#000000">) &lt;</span> <span style="color:#b07e00">0</span><span style="color:#000000">)</span>     <span style="color:#000000; font-weight:bold">return</span> <span style="color:#000000">+</span><span style="color:#b07e00">2</span><span style="color:#000000">;</span> <span style="color:#838183; font-style:italic">// cab (back)</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">abs</span><span style="color:#000000">(</span>b<span style="color:#000000">) &lt;</span> <span style="color:#010181">abs</span><span style="color:#000000">(</span>c<span style="color:#000000">))</span>   <span style="color:#000000; font-weight:bold">return</span> <span style="color:#000000">-</span><span style="color:#b07e00">2</span><span style="color:#000000">;</span> <span style="color:#838183; font-style:italic">// abc (front)</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>                        <span style="color:#838183; font-style:italic">// acb (on segment)</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 直交判定</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_2_A</span>
<span style="color:#0057ae">bool</span> <span style="color:#010181">isOrthogonalLL</span><span style="color:#000000">(</span>P a1<span style="color:#000000">,</span> P a2<span style="color:#000000">,</span> P b1<span style="color:#000000">,</span> P b2<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">EQ</span><span style="color:#000000">(</span><span style="color:#010181">dot</span><span style="color:#000000">(</span>a1<span style="color:#000000">-</span>a2<span style="color:#000000">,</span> b1<span style="color:#000000">-</span>b2<span style="color:#000000">),</span> <span style="color:#b07e00">0.0</span><span style="color:#000000">);</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 平行判定</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_2_A</span>
<span style="color:#0057ae">bool</span> <span style="color:#010181">isParallelLL</span><span style="color:#000000">(</span>P a1<span style="color:#000000">,</span> P a2<span style="color:#000000">,</span> P b1<span style="color:#000000">,</span> P b2<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">EQ</span><span style="color:#000000">(</span><span style="color:#010181">cross</span><span style="color:#000000">(</span>a1<span style="color:#000000">-</span>a2<span style="color:#000000">,</span> b1<span style="color:#000000">-</span>b2<span style="color:#000000">),</span> <span style="color:#b07e00">0.0</span><span style="color:#000000">);</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 線分と線分の交差判定</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_2_B</span>
<span style="color:#0057ae">bool</span> <span style="color:#010181">isIntersectedSS</span><span style="color:#000000">(</span>P a1<span style="color:#000000">,</span> P a2<span style="color:#000000">,</span> P b1<span style="color:#000000">,</span> P b2<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">ccw</span><span style="color:#000000">(</span>a1<span style="color:#000000">,</span> a2<span style="color:#000000">,</span> b1<span style="color:#000000">)*</span><span style="color:#010181">ccw</span><span style="color:#000000">(</span>a1<span style="color:#000000">,</span> a2<span style="color:#000000">,</span> b2<span style="color:#000000">) &lt;=</span> <span style="color:#b07e00">0</span> <span style="color:#000000">&amp;&amp;</span>
           <span style="color:#010181">ccw</span><span style="color:#000000">(</span>b1<span style="color:#000000">,</span> b2<span style="color:#000000">,</span> a1<span style="color:#000000">)*</span><span style="color:#010181">ccw</span><span style="color:#000000">(</span>b1<span style="color:#000000">,</span> b2<span style="color:#000000">,</span> a2<span style="color:#000000">) &lt;=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 直線と直線の交点</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_2_C</span>
P <span style="color:#010181">intersectionLL</span><span style="color:#000000">(</span>P a1<span style="color:#000000">,</span> P a2<span style="color:#000000">,</span> P b1<span style="color:#000000">,</span> P b2<span style="color:#000000">) {</span>
    P a <span style="color:#000000">=</span> a2 <span style="color:#000000">-</span> a1<span style="color:#000000">;</span>
    P b <span style="color:#000000">=</span> b2 <span style="color:#000000">-</span> b1<span style="color:#000000">;</span>
    <span style="color:#000000; font-weight:bold">return</span> a1 <span style="color:#000000">+</span> a<span style="color:#000000">*</span><span style="color:#010181">cross</span><span style="color:#000000">(</span>b<span style="color:#000000">,</span> b1<span style="color:#000000">-</span>a1<span style="color:#000000">)/</span><span style="color:#010181">cross</span><span style="color:#000000">(</span>b<span style="color:#000000">,</span> a<span style="color:#000000">);</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 直線と点の距離</span>
<span style="color:#0057ae">double</span> <span style="color:#010181">distLP</span><span style="color:#000000">(</span>P a<span style="color:#000000">,</span> P b<span style="color:#000000">,</span> P p<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">abs</span><span style="color:#000000">(</span><span style="color:#010181">cross</span><span style="color:#000000">(</span>b<span style="color:#000000">-</span>a<span style="color:#000000">,</span> p<span style="color:#000000">-</span>a<span style="color:#000000">)) /</span> <span style="color:#010181">abs</span><span style="color:#000000">(</span>b<span style="color:#000000">-</span>a<span style="color:#000000">);</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 線分と点の距離</span>
<span style="color:#0057ae">double</span> <span style="color:#010181">distSP</span><span style="color:#000000">(</span>P a<span style="color:#000000">,</span> P b<span style="color:#000000">,</span> P p<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">dot</span><span style="color:#000000">(</span>b<span style="color:#000000">-</span>a<span style="color:#000000">,</span> p<span style="color:#000000">-</span>a<span style="color:#000000">) &lt;</span> EPS<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">abs</span><span style="color:#000000">(</span>p<span style="color:#000000">-</span>a<span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">dot</span><span style="color:#000000">(</span>a<span style="color:#000000">-</span>b<span style="color:#000000">,</span> p<span style="color:#000000">-</span>b<span style="color:#000000">) &lt;</span> EPS<span style="color:#000000">)</span> <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">abs</span><span style="color:#000000">(</span>p<span style="color:#000000">-</span>b<span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">distLP</span><span style="color:#000000">(</span>a<span style="color:#000000">,</span> b<span style="color:#000000">,</span> p<span style="color:#000000">);</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 線分と線分の距離</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_2_D</span>
<span style="color:#0057ae">double</span> <span style="color:#010181">distSS</span><span style="color:#000000">(</span>P a1<span style="color:#000000">,</span> P a2<span style="color:#000000">,</span> P b1<span style="color:#000000">,</span> P b2<span style="color:#000000">) {</span>
    <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">isIntersectedSS</span><span style="color:#000000">(</span>a1<span style="color:#000000">,</span> a2<span style="color:#000000">,</span> b1<span style="color:#000000">,</span> b2<span style="color:#000000">)){</span>
        <span style="color:#000000; font-weight:bold">return</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">return</span> <span style="color:#010181">min</span><span style="color:#000000">({</span>
            <span style="color:#010181">distSP</span><span style="color:#000000">(</span>a1<span style="color:#000000">,</span> a2<span style="color:#000000">,</span> b1<span style="color:#000000">),</span>
            <span style="color:#010181">distSP</span><span style="color:#000000">(</span>a1<span style="color:#000000">,</span> a2<span style="color:#000000">,</span> b2<span style="color:#000000">),</span>
            <span style="color:#010181">distSP</span><span style="color:#000000">(</span>b1<span style="color:#000000">,</span> b2<span style="color:#000000">,</span> a1<span style="color:#000000">),</span>
            <span style="color:#010181">distSP</span><span style="color:#000000">(</span>b1<span style="color:#000000">,</span> b2<span style="color:#000000">,</span> a2<span style="color:#000000">),</span>
            <span style="color:#000000">});</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 多角形の面積 (点は半時計回り)</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_3_A</span>
<span style="color:#0057ae">double</span> <span style="color:#010181">area</span><span style="color:#000000">(</span>PL pl<span style="color:#000000">) {</span>
    <span style="color:#0057ae">double</span> ret <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    <span style="color:#0057ae">int</span> n <span style="color:#000000">=</span> pl<span style="color:#000000">.</span><span style="color:#010181">size</span><span style="color:#000000">();</span>
    <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> i<span style="color:#000000">=</span><span style="color:#b07e00">0</span><span style="color:#000000">;</span>i<span style="color:#000000">&lt;</span>n<span style="color:#000000">;</span>i<span style="color:#000000">++){</span>
        ret <span style="color:#000000">+=</span> <span style="color:#010181">cross</span><span style="color:#000000">(</span>pl<span style="color:#000000">[</span>i<span style="color:#000000">],</span> pl<span style="color:#000000">[(</span>i<span style="color:#000000">+</span><span style="color:#b07e00">1</span><span style="color:#000000">)%</span>n<span style="color:#000000">]);</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">return</span> ret <span style="color:#000000">/</span> <span style="color:#b07e00">2.0</span><span style="color:#000000">;</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 凸多角形判定 (点は半時計回り)</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_3_B</span>
<span style="color:#0057ae">bool</span> <span style="color:#010181">isConvex</span><span style="color:#000000">(</span>PL pl<span style="color:#000000">) {</span>
    <span style="color:#0057ae">int</span> n <span style="color:#000000">=</span> pl<span style="color:#000000">.</span><span style="color:#010181">size</span><span style="color:#000000">();</span>
    <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> i<span style="color:#000000">=</span><span style="color:#b07e00">0</span><span style="color:#000000">;</span>i<span style="color:#000000">&lt;</span>n<span style="color:#000000">;</span>i<span style="color:#000000">++){</span>
        <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">ccw</span><span style="color:#000000">(</span>pl<span style="color:#000000">[</span>i<span style="color:#000000">],</span> pl<span style="color:#000000">[(</span>i<span style="color:#000000">+</span><span style="color:#b07e00">1</span><span style="color:#000000">)%</span>n<span style="color:#000000">],</span> pl<span style="color:#000000">[(</span>i<span style="color:#000000">+</span><span style="color:#b07e00">2</span><span style="color:#000000">)%</span>n<span style="color:#000000">]) == -</span><span style="color:#b07e00">1</span><span style="color:#000000">){</span>
            <span style="color:#000000; font-weight:bold">return false</span><span style="color:#000000">;</span>
        <span style="color:#000000">}</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">return true</span><span style="color:#000000">;</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 点の多角形内外判定 (点は半時計回り)</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_3_C</span>
<span style="color:#0057ae">int</span> <span style="color:#010181">isContain</span><span style="color:#000000">(</span>PL pl<span style="color:#000000">,</span> P p<span style="color:#000000">) {</span>
    <span style="color:#0057ae">bool</span> flag <span style="color:#000000">=</span> <span style="color:#000000; font-weight:bold">false</span><span style="color:#000000">;</span>
    <span style="color:#0057ae">int</span> n <span style="color:#000000">=</span> pl<span style="color:#000000">.</span><span style="color:#010181">size</span><span style="color:#000000">();</span>
    <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> i<span style="color:#000000">=</span><span style="color:#b07e00">0</span><span style="color:#000000">;</span>i<span style="color:#000000">&lt;</span>n<span style="color:#000000">;</span>i<span style="color:#000000">++){</span>
        P a <span style="color:#000000">=</span> pl<span style="color:#000000">[</span>i<span style="color:#000000">] -</span> p<span style="color:#000000">;</span>
        P b <span style="color:#000000">=</span> pl<span style="color:#000000">[(</span>i<span style="color:#000000">+</span><span style="color:#b07e00">1</span><span style="color:#000000">)%</span>n<span style="color:#000000">] -</span> p<span style="color:#000000">;</span>
        <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">imag</span><span style="color:#000000">(</span>a<span style="color:#000000">) &gt;</span> <span style="color:#010181">imag</span><span style="color:#000000">(</span>b<span style="color:#000000">))</span> <span style="color:#010181">swap</span><span style="color:#000000">(</span>a<span style="color:#000000">,</span> b<span style="color:#000000">);</span>
        <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">imag</span><span style="color:#000000">(</span>a<span style="color:#000000">) &lt;=</span> <span style="color:#b07e00">0</span> <span style="color:#000000">&amp;&amp;</span> <span style="color:#b07e00">0</span> <span style="color:#000000">&lt;</span> <span style="color:#010181">imag</span><span style="color:#000000">(</span>b<span style="color:#000000">)){</span>
            <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">cross</span><span style="color:#000000">(</span>a<span style="color:#000000">,</span> b<span style="color:#000000">) &lt;</span> <span style="color:#b07e00">0</span><span style="color:#000000">)</span> flag <span style="color:#000000">= !</span>flag<span style="color:#000000">;</span>
        <span style="color:#000000">}</span>
        <span style="color:#000000; font-weight:bold">if</span><span style="color:#000000">(</span><span style="color:#010181">cross</span><span style="color:#000000">(</span>a<span style="color:#000000">,</span> b<span style="color:#000000">) ==</span> <span style="color:#b07e00">0</span> <span style="color:#000000">&amp;&amp;</span> <span style="color:#010181">dot</span><span style="color:#000000">(</span>a<span style="color:#000000">,</span> b<span style="color:#000000">) &lt;=</span> <span style="color:#b07e00">0</span><span style="color:#000000">){</span>
            <span style="color:#000000; font-weight:bold">return</span> <span style="color:#b07e00">1</span><span style="color:#000000">;</span>       <span style="color:#838183; font-style:italic">// on segment</span>
        <span style="color:#000000">}</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">return</span> flag ? <span style="color:#b07e00">2</span> <span style="color:#000000">:</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>    <span style="color:#838183; font-style:italic">// in or out</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// 凸包 (plは点集合)</span>
<span style="color:#838183; font-style:italic">// verified AOJ CGL_4_A</span>
PL <span style="color:#010181">convexHull</span><span style="color:#000000">(</span>PL pl<span style="color:#000000">){</span>
    <span style="color:#0057ae">int</span> n <span style="color:#000000">=</span> pl<span style="color:#000000">.</span><span style="color:#010181">size</span><span style="color:#000000">();</span>
    <span style="color:#0057ae">int</span> k <span style="color:#000000">=</span> <span style="color:#b07e00">0</span><span style="color:#000000">;</span>
    PL <span style="color:#010181">ch</span><span style="color:#000000">(</span><span style="color:#b07e00">2</span><span style="color:#000000">*</span>n<span style="color:#000000">);</span> <span style="color:#838183; font-style:italic">// results</span>
    <span style="color:#010181">sort</span><span style="color:#000000">(</span>pl<span style="color:#000000">.</span><span style="color:#010181">begin</span><span style="color:#000000">(),</span> pl<span style="color:#000000">.</span><span style="color:#010181">end</span><span style="color:#000000">());</span> <span style="color:#838183; font-style:italic">// この順序は問題に依る</span>
    <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> i<span style="color:#000000">=</span><span style="color:#b07e00">0</span><span style="color:#000000">;</span>i<span style="color:#000000">&lt;</span>n<span style="color:#000000">;</span>ch<span style="color:#000000">[</span>k<span style="color:#000000">++]=</span>pl<span style="color:#000000">[</span>i<span style="color:#000000">++]){</span>
        <span style="color:#000000; font-weight:bold">while</span><span style="color:#000000">(</span>k <span style="color:#000000">&gt;=</span> <span style="color:#b07e00">2</span> <span style="color:#000000">&amp;&amp; (</span><span style="color:#010181">ccw</span><span style="color:#000000">(</span>ch<span style="color:#000000">[</span>k<span style="color:#000000">-</span><span style="color:#b07e00">2</span><span style="color:#000000">],</span> ch<span style="color:#000000">[</span>k<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">],</span> pl<span style="color:#000000">[</span>i<span style="color:#000000">]) ==</span> <span style="color:#b07e00">0</span> <span style="color:#000000">||</span>
                         <span style="color:#010181">ccw</span><span style="color:#000000">(</span>ch<span style="color:#000000">[</span>k<span style="color:#000000">-</span><span style="color:#b07e00">2</span><span style="color:#000000">],</span> ch<span style="color:#000000">[</span>k<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">],</span> pl<span style="color:#000000">[</span>i<span style="color:#000000">]) == -</span><span style="color:#b07e00">1</span><span style="color:#000000">))</span> k<span style="color:#000000">--;</span>
    <span style="color:#000000">}</span>
    <span style="color:#000000; font-weight:bold">for</span><span style="color:#000000">(</span><span style="color:#0057ae">int</span> i<span style="color:#000000">=</span>n<span style="color:#000000">-</span><span style="color:#b07e00">2</span><span style="color:#000000">,</span>t<span style="color:#000000">=</span>k<span style="color:#000000">+</span><span style="color:#b07e00">1</span><span style="color:#000000">;</span>i<span style="color:#000000">&gt;=</span><span style="color:#b07e00">0</span><span style="color:#000000">;</span>ch<span style="color:#000000">[</span>k<span style="color:#000000">++]=</span>pl<span style="color:#000000">[</span>i<span style="color:#000000">--]){</span>
        <span style="color:#000000; font-weight:bold">while</span><span style="color:#000000">(</span>k <span style="color:#000000">&gt;=</span> t <span style="color:#000000">&amp;&amp; (</span><span style="color:#010181">ccw</span><span style="color:#000000">(</span>ch<span style="color:#000000">[</span>k<span style="color:#000000">-</span><span style="color:#b07e00">2</span><span style="color:#000000">],</span> ch<span style="color:#000000">[</span>k<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">],</span> pl<span style="color:#000000">[</span>i<span style="color:#000000">]) ==</span> <span style="color:#b07e00">0</span> <span style="color:#000000">||</span>
                         <span style="color:#010181">ccw</span><span style="color:#000000">(</span>ch<span style="color:#000000">[</span>k<span style="color:#000000">-</span><span style="color:#b07e00">2</span><span style="color:#000000">],</span> ch<span style="color:#000000">[</span>k<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">],</span> pl<span style="color:#000000">[</span>i<span style="color:#000000">]) == -</span><span style="color:#b07e00">1</span><span style="color:#000000">))</span> k<span style="color:#000000">--;</span>
    <span style="color:#000000">}</span>
    ch<span style="color:#000000">.</span><span style="color:#010181">resize</span><span style="color:#000000">(</span>k<span style="color:#000000">-</span><span style="color:#b07e00">1</span><span style="color:#000000">);</span>
    <span style="color:#000000; font-weight:bold">return</span> ch<span style="color:#000000">;</span>
<span style="color:#000000">}</span>

<span style="color:#838183; font-style:italic">// }}}</span></code></pre>
</div></div>
</div>
</div>
</div>
</div>
<h2>脚注</h2>
<div id='footnotes'></div>
<hr>
<p>last update 2017-07-06 21:38:34 (UTC)</p>
<p>this page is generated by <a href='https://github.com/monman53/monsta'>monsta</a></p>
<script src='/js/asciidoc.js'></script>
<script>asciidoc.install(1);</script>
<script src='/js/LaTeXMathML.js'></script>
<script src='/js/ASCIIMathML.js'></script>
