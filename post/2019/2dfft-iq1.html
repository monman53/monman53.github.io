<!doctype html><html lang='ja'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width, initial-scale=1'><link rel='shortcut icon' type='image/png' href='/images/favicon.png'/><title>2次元高速フーリエ変換をWebGLでがんばる : monman53</title><script>MathJax = {tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]}}</script><script id='MathJax-script' async src='/scripts/mathjax/tex-chtml.js'></script><link rel='stylesheet' href='/styles/main.css'><script async src='https://www.googletagmanager.com/gtag/js?id=UA-111264044-1'></script><script src='/scripts/google.js'></script></head><body><header><div class='pad'><p class='bread'><a href='/'>monman53.github.io</a> / <a href='/post/'>post</a> / <a href='/post/2019/'>2019</a> / <a href='/post/2019/2dfft-iq1.html'>2dfft-iq1.html</a></p><p style='font-size: small;'>Last Modified : 2019-12-21 23:59:12 +0900</p></div></header><article><div class='pad'><h1>2次元高速フーリエ変換をWebGLでがんばる</h1><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>今年は「<a href="https://adventar.org/calendars/4115">IQ1 Advent Calendar 2019</a>」の1まいめにエントリーできました!</p>
</div>
<div class="paragraph">
<p>今回は2次元フーリエ変換(2DFFT)の話です．<br>
僕はYouTubeにある<a href="https://www.youtube.com/watch?v=qB0cffZpw-A">2次元逆フーリエ変換でアインシュタインが浮かび上がってくるデモ</a>が大好きで
「いつか自分でも」と思っていたので，この機会にWebGLを使って実装しました．(めっちゃ楽しかった!)</p>
</div>
<div class="paragraph">
<p><a href="https://monman53.github.io/demos/2dfft/index.html" class="bare">https://monman53.github.io/demos/2dfft/index.html</a> 2D Inverse Fourier Transform Playground
<a href="https://github.com/monman53/2dfft/">(source code)</a>
<span class="image"><a class="image" href="/demos/2dfft/"><img src="2dfft-iq1.jpg" alt="Screenshot of 2DFFT playground"></a></span></p>
</div>
<div class="paragraph">
<p>ほんの少し技術的な補足を書いておこうと思います．</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_フーリエ変換">フーリエ変換</h2>
<div class="sectionbody">
<div class="paragraph">
<p>次の2次元離散フーリエ変換・逆変換の式を用いました．$N$ は $2$ のべきとします．</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{eqnarray}
F[u, v] &amp;=&amp; \frac{1}{N}\sum^{N-1}_{y=0}\sum^{N-1}_{x=0}f[x, y]e^{-j2\pi(xu+yv)/N},  \\
f[x, y] &amp;=&amp; \frac{1}{N}\sum^{N-1}_{v=0}\sum^{N-1}_{u=0}F[u, v]e^{j2\pi(ux+vy)/N}  \\
\end{eqnarray}\]
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_高速フーリエ変換">高速フーリエ変換</h2>
<div class="sectionbody">
<div class="paragraph">
<p>1次元の高速フーリエ変換では，式を偶数項と奇数項に分けて，指数の肩に乗る整数のmodをとるところが肝です．<br>
2次元の場合でも同様に4つの式に分割することで高速フーリエ変換が実現されます．</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{eqnarray}
F[u, v] &amp;=&amp;                   \frac{1}{N}\sum^{N/2-1}_{y=0}\sum^{N/2-1}_{x=0}f[2x, 2y]    e^{-j2\pi(xu+yv)/(N/2)}  \\
        &amp;+&amp; e^{-j2\pi u/N}    \frac{1}{N}\sum^{N/2-1}_{y=0}\sum^{N/2-1}_{x=0}f[2x+1, 2y]  e^{-j2\pi(xu+yv)/(N/2)}  \\
        &amp;+&amp; e^{-j2\pi v/N}    \frac{1}{N}\sum^{N/2-1}_{y=0}\sum^{N/2-1}_{x=0}f[2x, 2y+1]  e^{-j2\pi(xu+yv)/(N/2)}  \\
        &amp;+&amp; e^{-j2\pi (u+v)/N}\frac{1}{N}\sum^{N/2-1}_{y=0}\sum^{N/2-1}_{x=0}f[2x+1, 2y+1]e^{-j2\pi(xu+yv)/(N/2)}
\end{eqnarray}\]
</div>
</div>
<div class="paragraph">
<p>逆変換も同様です．</p>
</div>
<div class="paragraph">
<p>2次元フーリエ変換は1次元フーリエ変換を縦方向と横方向に施す実装方法がありますが，
せっかくなので今回はこの式をそのまま使った実装をしてみました．</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_実装適当">実装(適当)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>1次元の高速フーリエ変換の場合，
バラフライ演算の図の1点を計算するのに2点の値を参照します．<br>
2次元の場合は先程の式からわかるように4点の値を参照することになります．</p>
</div>
<div class="paragraph">
<p>テクスチャを2枚用意し，テクスチャ4点をサンプリングして計算するFFT用シェーダでテクスチャレンダリングをします．<br>
そして2枚のテクスチャをswapしながらこれを $\log(N)$ 回繰り返します．<br></p>
</div>
<div class="paragraph">
<p>そのほかUI用に別の複数のテクスチャやシェーダが使われています．<br>
マウスのイベントに反応して，その都度テクスチャレンダリングのパイプラインシステムが動作します．</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ひとこと">ひとこと</h2>
<div class="sectionbody">
<div class="paragraph">
<p>修論とは&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>明日はcrskさんが何か添えてくれるみたいですね!</p>
</div>
<div class="paragraph">
<p><a href="https://adventar.org/calendars/4115">IQ1 Advent Calendar 2019</a></p>
</div>
</div>
</div></div></article><footer><div class='pad'><p>Last Modified : 2019-12-21 23:59:12 +0900</p><p><a href='/'>monman53.github.io</a></p><p>This page is generated by <a href='https://github.com/monman53/monsta'>monsta</a>.</p><p><a rel='license' href='http://creativecommons.org/licenses/by/4.0/'><img alt='Creative Commons License' style='border-width:0' src='/images/cc-by.png' height='30px'/></a><br>This work is licensed under a <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'>Creative Commons Attribution 4.0 International License</a>.</p></div></footer></body></html>
